<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>AI ERP Assistant</title>

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" />

    <!-- Markdown + 3D Assets -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css" />
</head>
<body>

<!-- Animated Background -->
<div class="cyber-grid"></div>
<div class="glow-bg"></div>
<div class="gradient-overlay"></div>
<div class="particle-field" id="particleField"></div>

<!-- Header -->
<header>
    <div class="header-brand">
        <div class="logo-icon">
            <i class="fa-solid fa-robot"></i>
        </div>
        <h2>
            <span class="text-gradient">AI ERP Assistant</span>
            <span class="status-indicator"></span>
        </h2>
    </div>
    <div class="header-actions">
        <button class="btn-glass" onclick="location.reload()" aria-label="Refresh">
            <i class="fa-solid fa-rotate-right"></i>
            <span class="btn-text">Refresh</span>
        </button>
        <button id="historyBtn" class="btn-glass" title="Chat History" aria-label="Chat History">
            <i class="fa-solid fa-clock-rotate-left"></i>
            <span class="btn-text">History</span>
        </button>
        <button id="themeToggle" class="btn-glass" title="Toggle Theme" aria-label="Toggle Theme">
            <i class="fa-solid fa-moon"></i>
        </button>
    </div>
</header>

<!-- Sidebar -->
<aside id="SideBar">
    <div class="sidebar-header">
        <h3><i class="fa-solid fa-comments"></i> Chat History</h3>
        <button class="sidebar-close" id="sidebarClose" aria-label="Close sidebar">
            <i class="fa-solid fa-xmark"></i>
        </button>
    </div>

    <div class="sidebar-controls">
        <select id="sortHistory" class="glass-select">
            <option value="date">ðŸ“… Sort by Date</option>
            <option value="topic">ðŸ“‚ Sort by Topic</option>
        </select>

        <div class="search-wrapper">
            <i class="fa-solid fa-magnifying-glass search-icon"></i>
            <input type="text" id="searchHistory" placeholder="Search history..." />
        </div>
    </div>

    <div id="historyList" class="fancy-scroll">
        <!-- Chat history dynamically injected -->
    </div>

    <button id="clearHistory" class="btn-danger">
        <i class="fa-solid fa-trash"></i> Clear All
    </button>
</aside>

<!-- Main Content -->
<main id="chatContainer" class="fancy-scroll">
    <div class="ai-message welcome-message fade-in">
        <div class="ai-avatar">
            <i class="fa-solid fa-circle-user"></i>
            <span class="avatar-pulse"></span>
        </div>

        <div class="ai-text">
            <strong class="welcome-title">Hello ðŸ‘‹</strong>
            <p>I'm your AI ERP Assistant â€” ready to simplify your work. Try asking about reports, users, or real-time stats.</p>
            <div class="quick-actions">
                <button class="quick-btn" data-prompt="Show me the dashboard">
                    <i class="fa-solid fa-chart-line"></i> Dashboard
                </button>
                <button class="quick-btn" data-prompt="Generate a report">
                    <i class="fa-solid fa-file-alt"></i> Reports
                </button>
                <button class="quick-btn" data-prompt="User management">
                    <i class="fa-solid fa-users"></i> Users
                </button>
            </div>
        </div>
    </div>

    <!-- DFD Container -->
    <div id="myDfdContainer" class="dfd-container"></div>
</main>

<!-- Input Area -->
<div id="inputArea">
    <div class="file-section">
        <label id="fileLabel" class="file-label">
            <i class="fa-solid fa-paperclip"></i>
            <span class="label-text">Attach</span>
        </label>
        <button id="AddFiles" aria-label="Add files">
            <i class="fa-solid fa-plus"></i>
        </button>
        <input type="file" id="fileInput" style="display:none" multiple accept="image/*,.pdf,.doc,.docx,.txt" />
    </div>

    <button id="micBtn" class="mic-btn" title="Voice Input" aria-label="Voice Input">
        <i class="fa-solid fa-microphone"></i>
        <span class="mic-pulse"></span>
    </button>

    <div class="input-wrapper">
        <input
                type="text"
                id="userInput"
                placeholder="Ask something to AI Assistant..."
                aria-label="User Input"
        />
        <div class="input-glow"></div>
    </div>

    <button onclick="sendToAI()" title="Send Message" class="send-btn" aria-label="Send Message">
        <i class="fa-solid fa-paper-plane"></i>
    </button>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="loader-container">
        <div class="cyber-loader"></div>
        <p>Processing...</p>
    </div>
</div>

<!-- Scripts -->
<script src="Script.js" defer></script>
<script type="module" src="/JS/avatar.js"></script>
</body>
</html>